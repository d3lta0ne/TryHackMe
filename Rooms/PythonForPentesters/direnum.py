"""
The following code is taken from the Python for Pentesters Lab @tryhackme.
"""
import sys
import requests

with open("wordlist.txt",  encoding="utf-8") as file:
    sub_list = file.read()
    directories = sub_list.splitlines()

    for directory in directories:
        dir_enum = f"http://{sys.argv[1]}/{directory}.html"
        try:
            r = requests.get(dir_enum, timeout=10)
            if r.status_code == 404:
                pass
            else:
                print("Valid directory:", dir_enum)
        except requests.exceptions.ConnectTimeout as e:
            print(f"Connection timed out: {e}")
            # Handle the timeout, e.g., retrying, logging, or raising a custom exception
    file.close()
