"""Module for cracking hashes"""
import hashlib
import sys
import pyfiglet

ASCII_BANNER = pyfiglet.figlet_format("TryHackMe \n Python 4 Pentesters \n HASH CRACKER for MD 5")

def main():
    wordlist_src = str(input('Enter wordlist file location: '))
    hash_input = str(input('Enter hash to be cracked: '))

    print(ASCII_BANNER)
    
    with open(wordlist_src, 'r', encoding="utf-8") as file:
        for line in file.readlines():
            hash_ob = hashlib.md5(line.strip().encode())
            hashed_pass = hash_ob.hexdigest()
            if hashed_pass == hash_input:
                print('Found cleartext password! ' + line.strip())
                sys.exit(0)

if __name__ == "__main__":
    main()
    